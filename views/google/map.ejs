<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <title>Map</title>
  <link rel="stylesheet" href="/css/mapStyle.css">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.1.1/jquery.min.js"></script>
</head>
<body>
  <form action="/search" method="POST">
    <input type="text" name="term" placeholder="What are you in a mood for?">
    <input type="text" name="location" placeholder="Location">
    <input type="submit" value="Search">
  </form>

  <!-- yelp results -->
  <input id="result-1" type="hidden" value="<%= latlngArray[0] %>">
  <input id="result-2" type="hidden" value="<%= latlngArray[1] %>">
  <input id="result-3" type="hidden" value="<%= latlngArray[2] %>">

  <input id="result-1-name" type="hidden" value="<%= results[0].name %>">
  <input id="result-1-addr" type="hidden" value="<%= results[0].location.address %>">
  <input id="result-2-name" type="hidden" value="<%= results[1].name %>">
  <input id="result-2-addr" type="hidden" value="<%= results[1].location.address %>">
  <input id="result-3-name" type="hidden" value="<%= results[2].name %>">
  <input id="result-3-addr" type="hidden" value="<%= results[2].location.address %>">


  <div class="search-results">
    <% results.forEach(element => { %>
      <div class="business-info">
        <img class="business-img" src="<%= element.image_url %>" alt="businenss-img">
        <h3 clas="business-name"><%= element.name %></h3>
        <img src="<%= element.rating_img_url %>" alt="review-img">
        <p class="business-reviews"><%= element.review_count %></p>
        <p class="business-addr"><%= element.location.display_address %></p>
        <p class="business-phone"><%= element.phone %></p>

        <form class="save" action="/favorites" method="POST">
          <input type="hidden" name="favorite[image_url]" value="<%= element.image_url %>">
          <input type="hidden" name="favorite[name]" value="<%= element.name %>">
          <input type="hidden" name="favorite[rating_img_url]" value="<%= element.rating_img_url %>">
          <input type="hidden" name="favorite[review_count]" value="<%= element.review_count %>">
          <input type="hidden" name="favorite[display_addr]" value="<%= element.location.display_address %>">
          <input type="hidden" name="favorite[phone]" value="<%= element.phone %>">
          <input type="submit" value="Save">
        </form>
      </div>
    <% }) %>
  </div>


  <div id="map"></div>

  <script type="text/javascript" src="/js/mapScript.js"></script>
  <script async defer
  src="https://maps.googleapis.com/maps/api/js?key=<%= GOOGLE_MAP_API_KEY %>&callback=initMap">
  </script>
</body>
</html>
